{% extends 'base2.html' %}

{% block title %} View Recipes {% endblock %}

{% block content %}


	{% if recipes != [] %}
		<h2> Hello, {{ session["name"] }}. We found the following recipes for you. </h2>
	
		   {% for recipe in recipes %}
		   <div class="container2"> 
		       <p><img src= {{ recipe['recipe_image'] }}></p>
		       <p><h3>{{ recipe['recipe_name'] }} </h3></p>
		       <form action="{{ recipe['recipe_blog_url'] }}">
    			<input type="submit" class="nutritionbutton" value="Nutrition Information" />
				</form>
				 <form action="{{ recipe['recipe_url'] }}">
    			<input type="submit" class="instructionbutton" value="Instructions" />
				</form>
		   	   <b><h6> Health Labels:</b>  
		            {% for label in recipe['labels'] %}
		   		      {{ label }} 
		     	    {% endfor %} </h6> 
<<<<<<< HEAD
		        <form action="/save-recipe" method="POST">
		   	    <button type="submit" class="submitbutton" id="#{{recipe['recipe_url']}}" name='recipeurl' value='{{recipe['recipe_url']}}'>Save Recipe</button>
		   	   <span id='#{{recipe['recipe_url']}}-message'></span>
		       </form> <hr> 	
		     //   <script>
    			"use strict";

    			function confirmation(result) {
    				alert(result);
    			}

    			function saveRecipe(evt) {
    				evt.preventDefault();

    				let savedRecipeUrl = {
    					"url": $("#{{recipe['recipe_url']}}").val(),
    				};

    				$.post("/save-recipe", 
    					savedRecipeUrl,
    					confirmation);
    			}

   			   $('#{{recipe['recipe_url']}}').on('click', saveRecipe);

   			   </script>
=======
		        <form action="/save-recipe" method="POST" class='saveform'>
		        <h6 id='content'>info</h6>
		   	    <button type="submit" class="submitbutton" id="{{recipe['recipeid']}}" name='url' value='{{recipe['recipe_url']}}'>Save Recipe</button>
		       </form> <hr> 	
>>>>>>> e7ce1e56d8c1e5e6f4ad90c7a1403c2600a63c7e

		   </div>
		{% endfor %}
	{% else %}
	    <h2> Sorry, {{ session["name"] }}. No recipes found with those criteria. Try to narrow your search. </h2>
 	{% endif %}
	</ul>

	<!-- use JS to prevent selecting high protein and low protein 
 -->
 <script src="https://code.jquery.com/jquery.js"></script> 
   		<script>
		"use strict";

		function confirmation(result) {
			// $('#content').load('/save-recipe')
		}

		function saveRecipe(evt) {
			console.log('got inside saveRecipe')
			console.log(evt)
			evt.preventDefault();
			let id = evt.currentTarget["0"].id
			console.log(id)


			let savedRecipeUrl = {
				"url": $(`#${id}`).val(),
				console.log(id);

			};
			// make sure this is getting id

			$.post("/save-recipe", 
				savedRecipeUrl,
				confirmation);
		}

		   $(".saveform").on("submit", saveRecipe);

		   </script>


{% endblock %}
